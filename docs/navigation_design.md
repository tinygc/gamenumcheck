# üß≠ Navigation Structure Design - Ê†™ÂºèÊäïË≥á„Ç∑„Éü„É•„É¨„Éº„Çø„Éº

## üìê Jetpack Navigation Ë®≠Ë®à

### **Navigation Graph ÊßãÈÄ†**

```kotlin
// „É°„Ç§„É≥„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥„Ç∞„É©„Éï
@Composable
fun StockSimNavHost(
    navController: NavHostController,
    startDestination: String
) {
    NavHost(
        navController = navController,
        startDestination = startDestination
    ) {
        // „Çπ„Éó„É©„ÉÉ„Ç∑„É•„Éª„Çø„Ç§„Éà„É´„Éï„É≠„Éº
        splashNavigation(navController)
        
        // „Ç≤„Éº„É†Ë®≠ÂÆö„Éï„É≠„Éº  
        gameSetupNavigation(navController)
        
        // „É°„Ç§„É≥„Ç≤„Éº„É†„Éï„É≠„Éº
        mainGameNavigation(navController)
        
        // ÁµêÊûú„ÉªË®≠ÂÆö„Éï„É≠„Éº
        resultNavigation(navController)
    }
}
```

### **ÁîªÈù¢ÂÆöÁæ© (Sealed Class)**

```kotlin
sealed class Screen(val route: String) {
    // „Çπ„Éó„É©„ÉÉ„Ç∑„É•„Éª„Çø„Ç§„Éà„É´Á≥ª
    object Splash : Screen("splash")
    object Title : Screen("title")
    object Settings : Screen("settings")
    
    // „Ç≤„Éº„É†ÈñãÂßãÁ≥ª
    object DifficultySelect : Screen("difficulty_select")
    object Tutorial : Screen("tutorial/{page}") {
        fun createRoute(page: Int) = "tutorial/$page"
    }
    
    // „É°„Ç§„É≥„Ç≤„Éº„É†Á≥ª
    object MainGame : Screen("main_game")
    object Home : Screen("home")
    object Trading : Screen("trading")
    object News : Screen("news") 
    object History : Screen("history")
    
    // Ë©≥Á¥∞ÁîªÈù¢Á≥ª
    object StockDetail : Screen("stock_detail/{symbol}") {
        fun createRoute(symbol: String) = "stock_detail/$symbol"
    }
    object TradeModal : Screen("trade_modal/{symbol}/{type}") {
        fun createRoute(symbol: String, type: String) = "trade_modal/$symbol/$type"
    }
    object Portfolio : Screen("portfolio")
    object NewsDetail : Screen("news_detail/{newsId}") {
        fun createRoute(newsId: String) = "news_detail/$newsId"
    }
    object Statistics : Screen("statistics")
    
    // „Ç≤„Éº„É†ÁµÇ‰∫ÜÁ≥ª
    object GameResult : Screen("game_result")
}
```

## üóÇÔ∏è Navigation Module Ë©≥Á¥∞Ë®≠Ë®à

### **1. „Çπ„Éó„É©„ÉÉ„Ç∑„É•„Éª„Çø„Ç§„Éà„É´„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥**

```kotlin
fun NavGraphBuilder.splashNavigation(navController: NavController) {
    composable(Screen.Splash.route) {
        SplashScreen(
            onNavigateToTitle = {
                navController.navigate(Screen.Title.route) {
                    popUpTo(Screen.Splash.route) { inclusive = true }
                }
            }
        )
    }
    
    composable(Screen.Title.route) {
        TitleScreen(
            onStartNewGame = {
                navController.navigate(Screen.DifficultySelect.route)
            },
            onContinueGame = {
                navController.navigate(Screen.MainGame.route)
            },
            onSettings = {
                navController.navigate(Screen.Settings.route)
            }
        )
    }
    
    composable(Screen.Settings.route) {
        SettingsScreen(
            onBack = { navController.popBackStack() }
        )
    }
}
```

### **2. „Ç≤„Éº„É†Ë®≠ÂÆö„Éï„É≠„Éº**

```kotlin
fun NavGraphBuilder.gameSetupNavigation(navController: NavController) {
    composable(Screen.DifficultySelect.route) {
        DifficultySelectScreen(
            onDifficultySelected = { difficulty ->
                // Èõ£ÊòìÂ∫¶„ÇíViewModel„Å´‰øùÂ≠ò
                navController.navigate(Screen.Tutorial.createRoute(0))
            },
            onBack = { navController.popBackStack() }
        )
    }
    
    composable(
        route = Screen.Tutorial.route,
        arguments = listOf(navArgument("page") { type = NavType.IntType })
    ) { backStackEntry ->
        val page = backStackEntry.arguments?.getInt("page") ?: 0
        
        TutorialScreen(
            currentPage = page,
            onNext = { nextPage ->
                if (nextPage < TUTORIAL_PAGES) {
                    navController.navigate(Screen.Tutorial.createRoute(nextPage))
                } else {
                    // „ÉÅ„É•„Éº„Éà„É™„Ç¢„É´ÂÆå‰∫Ü„ÄÅ„Ç≤„Éº„É†ÈñãÂßã
                    navController.navigate(Screen.MainGame.route) {
                        popUpTo(Screen.Title.route)
                    }
                }
            },
            onPrevious = { prevPage ->
                if (prevPage >= 0) {
                    navController.navigate(Screen.Tutorial.createRoute(prevPage))
                } else {
                    navController.popBackStack()
                }
            },
            onSkip = {
                navController.navigate(Screen.MainGame.route) {
                    popUpTo(Screen.Title.route)
                }
            }
        )
    }
}
```

### **3. „É°„Ç§„É≥„Ç≤„Éº„É†„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥**

```kotlin
fun NavGraphBuilder.mainGameNavigation(navController: NavController) {
    composable(Screen.MainGame.route) {
        // „Éú„Éà„É†„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥‰ªò„Åç„ÅÆ„É°„Ç§„É≥ÁîªÈù¢
        MainGameScreen(
            onGameComplete = {
                navController.navigate(Screen.GameResult.route) {
                    popUpTo(Screen.MainGame.route) { inclusive = true }
                }
            }
        )
    }
    
    // Ê†™ÂºèË©≥Á¥∞ÁîªÈù¢
    composable(
        route = Screen.StockDetail.route,
        arguments = listOf(navArgument("symbol") { type = NavType.StringType })
    ) { backStackEntry ->
        val symbol = backStackEntry.arguments?.getString("symbol") ?: ""
        
        StockDetailScreen(
            symbol = symbol,
            onBack = { navController.popBackStack() },
            onTrade = { symbol, tradeType ->
                navController.navigate(Screen.TradeModal.createRoute(symbol, tradeType))
            }
        )
    }
    
    // ÂèñÂºï„É¢„Éº„ÉÄ„É´
    composable(
        route = Screen.TradeModal.route,
        arguments = listOf(
            navArgument("symbol") { type = NavType.StringType },
            navArgument("type") { type = NavType.StringType }
        )
    ) { backStackEntry ->
        val symbol = backStackEntry.arguments?.getString("symbol") ?: ""
        val type = backStackEntry.arguments?.getString("type") ?: ""
        
        TradeModalScreen(
            symbol = symbol,
            tradeType = TradeType.valueOf(type.uppercase()),
            onDismiss = { navController.popBackStack() },
            onTradeComplete = { 
                // ÂèñÂºïÂÆå‰∫ÜÂæå„ÄÅË©≥Á¥∞ÁîªÈù¢„Å´Êàª„Çã
                navController.popBackStack()
            }
        )
    }
    
    // „Éù„Éº„Éà„Éï„Ç©„É™„Ç™Ë©≥Á¥∞
    composable(Screen.Portfolio.route) {
        PortfolioScreen(
            onBack = { navController.popBackStack() }
        )
    }
    
    // „Éã„É•„Éº„ÇπË©≥Á¥∞
    composable(
        route = Screen.NewsDetail.route,
        arguments = listOf(navArgument("newsId") { type = NavType.StringType })
    ) { backStackEntry ->
        val newsId = backStackEntry.arguments?.getString("newsId") ?: ""
        
        NewsDetailScreen(
            newsId = newsId,
            onBack = { navController.popBackStack() }
        )
    }
    
    // Áµ±Ë®àÁîªÈù¢
    composable(Screen.Statistics.route) {
        StatisticsScreen(
            onBack = { navController.popBackStack() }
        )
    }
}
```

### **4. „Éú„Éà„É†„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥ („É°„Ç§„É≥„Ç≤„Éº„É†ÂÜÖ)**

```kotlin
@Composable
fun MainGameScreen(
    onGameComplete: () -> Unit
) {
    val navController = rememberNavController()
    
    Scaffold(
        bottomBar = {
            BottomNavigation {
                val navBackStackEntry by navController.currentBackStackEntryAsState()
                val currentRoute = navBackStackEntry?.destination?.route
                
                bottomNavItems.forEach { item ->
                    BottomNavigationItem(
                        icon = { Icon(item.icon, contentDescription = item.label) },
                        label = { Text(item.label) },
                        selected = currentRoute == item.route,
                        onClick = {
                            navController.navigate(item.route) {
                                popUpTo(navController.graph.findStartDestination().id) {
                                    saveState = true
                                }
                                launchSingleTop = true
                                restoreState = true
                            }
                        }
                    )
                }
            }
        }
    ) { paddingValues ->
        NavHost(
            navController = navController,
            startDestination = Screen.Home.route,
            modifier = Modifier.padding(paddingValues)
        ) {
            composable(Screen.Home.route) {
                HomeScreen(
                    onStockClick = { symbol ->
                        // Â§ñÂÅ¥„ÅÆnavController„Çí‰ΩøÁî®
                        // ÂÆüÈöõ„ÅØ‰æùÂ≠òÊÄßÊ≥®ÂÖ•„ÅßËß£Ê±∫
                    },
                    onPortfolioClick = { /* „Éù„Éº„Éà„Éï„Ç©„É™„Ç™ÁîªÈù¢„Å∏ */ },
                    onNextDay = { isGameComplete ->
                        if (isGameComplete) {
                            onGameComplete()
                        }
                    }
                )
            }
            
            composable(Screen.Trading.route) {
                TradingScreen(
                    onStockClick = { symbol ->
                        // Ê†™ÂºèË©≥Á¥∞ÁîªÈù¢„Å∏
                    }
                )
            }
            
            composable(Screen.News.route) {
                NewsScreen(
                    onNewsClick = { newsId ->
                        // „Éã„É•„Éº„ÇπË©≥Á¥∞ÁîªÈù¢„Å∏
                    }
                )
            }
            
            composable(Screen.History.route) {
                HistoryScreen(
                    onStatisticsClick = {
                        // Áµ±Ë®àÁîªÈù¢„Å∏
                    }
                )
            }
        }
    }
}

data class BottomNavItem(
    val route: String,
    val icon: ImageVector,
    val label: String
)

val bottomNavItems = listOf(
    BottomNavItem(Screen.Home.route, Icons.Default.Home, "„Éõ„Éº„É†"),
    BottomNavItem(Screen.Trading.route, Icons.Default.TrendingUp, "ÂèñÂºï"),
    BottomNavItem(Screen.News.route, Icons.Default.Article, "„Éã„É•„Éº„Çπ"),
    BottomNavItem(Screen.History.route, Icons.Default.History, "Â±•Ê≠¥")
)
```

## üîÑ ÁîªÈù¢ÈÅ∑Áßª„ÅÆ„Éë„Çø„Éº„É≥

### **1. Replace (ÁΩÆ„ÅçÊèõ„Åà)**
```kotlin
// „Çø„Ç§„Éà„É´ ‚Üí „É°„Ç§„É≥„Ç≤„Éº„É† (Êàª„Çå„Å™„ÅÑ)
navController.navigate(Screen.MainGame.route) {
    popUpTo(Screen.Title.route) { inclusive = true }
}
```

### **2. Push („Çπ„Çø„ÉÉ„ÇØËøΩÂä†)**
```kotlin
// „Éõ„Éº„É† ‚Üí Ê†™ÂºèË©≥Á¥∞ (Êàª„Çã„Éú„Çø„É≥„ÅßÊàª„Çå„Çã)
navController.navigate(Screen.StockDetail.createRoute(symbol))
```

### **3. Modal („É¢„Éº„ÉÄ„É´Ë°®Á§∫)**
```kotlin
// Ê†™ÂºèË©≥Á¥∞ ‚Üí ÂèñÂºï„É¢„Éº„ÉÄ„É´
navController.navigate(Screen.TradeModal.createRoute(symbol, "BUY"))
```

### **4. Bottom Navigation („Çø„ÉñÂàá„ÇäÊõø„Åà)**
```kotlin
// „É°„Ç§„É≥„Ç≤„Éº„É†ÂÜÖ„ÅÆ„Çø„ÉñÈñìÁßªÂãï
navController.navigate(Screen.Trading.route) {
    popUpTo(navController.graph.findStartDestination().id) {
        saveState = true
    }
    launchSingleTop = true
    restoreState = true
}
```

## üéØ DeepLink ÂØæÂøú

```kotlin
// ÁâπÂÆö„ÅÆÊ†™ÂºèË©≥Á¥∞ÁîªÈù¢„Å∏„ÅÆÁõ¥Êé•ÈÅ∑Áßª
composable(
    route = Screen.StockDetail.route,
    deepLinks = listOf(navDeepLink { uriPattern = "stocksim://stock/{symbol}" })
) { ... }

// „Ç≤„Éº„É†Áä∂ÊÖãÂæ©Â∏∞Áî®
composable(
    route = Screen.MainGame.route,
    deepLinks = listOf(navDeepLink { uriPattern = "stocksim://game/day/{day}" })
) { ... }
```

## üîí Navigation Guard (ÁîªÈù¢ÈÅ∑ÁßªÂà∂Âæ°)

```kotlin
@Composable
fun NavigationGuard(
    gameState: GameState?,
    onNavigateToTitle: () -> Unit,
    content: @Composable () -> Unit
) {
    when {
        gameState == null -> {
            // „Ç≤„Éº„É†Áä∂ÊÖã„Å™„Åó ‚Üí „Çø„Ç§„Éà„É´„Å∏
            LaunchedEffect(Unit) {
                onNavigateToTitle()
            }
        }
        gameState.gameStatus == GameStatus.COMPLETED -> {
            // „Ç≤„Éº„É†ÂÆå‰∫Ü ‚Üí ÁµêÊûúÁîªÈù¢„Å∏
            LaunchedEffect(gameState) {
                // ResultÁîªÈù¢„Å∏„ÅÆÈÅ∑ÁßªÂá¶ÁêÜ
            }
        }
        else -> {
            content()
        }
    }
}
```

## üì± Áä∂ÊÖã‰øùÂ≠ò„ÉªÂæ©ÂÖÉ

```kotlin
// ViewModel„Åß„ÅÆ„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥Áä∂ÊÖãÁÆ°ÁêÜ
class NavigationViewModel : ViewModel() {
    private val _navigationState = MutableStateFlow<NavigationState?>(null)
    val navigationState = _navigationState.asStateFlow()
    
    fun saveNavigationState(route: String, arguments: Bundle?) {
        _navigationState.value = NavigationState(route, arguments)
    }
    
    fun restoreNavigation(): NavigationState? {
        return _navigationState.value
    }
}

data class NavigationState(
    val route: String,
    val arguments: Bundle?
)
```

„Åì„ÅÆË®≠Ë®à„Åß„Çπ„É†„Éº„Ç∫„ÅßÁõ¥ÊÑüÁöÑ„Å™„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥„ÅåÂÆüÁèæ„Åß„Åç„Çã„Çà„Äú‚ô° Jetpack Navigation„ÅÆÊ©üËÉΩ„Çí„Éï„É´Ê¥ªÁî®„Åó„Å¶„É¶„Éº„Ç∂„Éì„É™„ÉÜ„Ç£ÊäúÁæ§„Å´„Å™„Çä„Åù„ÅÜ‚ú®